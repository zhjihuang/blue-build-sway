---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json

name: blue-build-sway-surface-nvidia
description: This is my personal OS image.
base-image: 'quay.io/fedora/fedora-sway-atomic'
image-version: 42
modules:
  - type: files
    files:
      - source: systems/base/
        destination: /
  - from-file: kernels/install-kernel-surface.yml
  - from-file: kernels/install-akmod-nvidia.yml
  - from-file: kernels/sign-kernel.yml
  - type: script
    snippets:                                                                                                 
      - systemctl enable nvidia-suspend.service nvidia-resume.service nvidia-hibernate.service nvidia-suspend-then-hibernate.service
      - systemctl disable nvidia-persistenced.service
  - from-file: packages/remove-packages-common.yml
  - from-file: packages/install-packages-common.yml
  - from-file: packages/install-packages-surface.yml
  - from-file: packages/install-packages-surface-nvidia.yml
  - type: script
    snippets:                                                                                                 
      - systemctl enable switcheroo-control.service
  # Sets up the proper policy & signing files for signed images to work fully.
  - type: signing
